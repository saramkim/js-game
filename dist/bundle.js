(() => {
  'use strict';
  var t = document.getElementById('canvas'),
    i = t.getContext('2d');
  for (
    t.width = 600,
      t.height = 800,
      t.style.border = '1px solid black',
      t.style.position = 'fixed',
      t.style.left = 'calc(50% - '.concat(t.width / 2, 'px)'),
      t.style.top = 'calc(50% - '.concat(t.height / 2, 'px)');
    window.innerWidth < t.width;

  )
    (t.width -= 20), (t.style.left = 'calc(50% - '.concat(t.width / 2, 'px)'));
  for (; window.innerHeight < t.height; )
    (t.height -= 50), (t.style.top = 'calc(50% - '.concat(t.height / 2, 'px)'));
  var e,
    n,
    c = {
      width: 50,
      height: 50,
      x: (t.width - 50) / 2,
      y: t.height - 50,
      draw: function () {
        (i.fillStyle = 'green'),
          i.fillRect(this.x, this.y, this.width, this.height);
      },
    },
    o = (function () {
      function e(i) {
        (this.width = 50),
          (this.height = 50),
          (this.x =
            Math.random() * (t.width / x - this.width) + i * (t.width / x)),
          (this.y = 0);
      }
      return (
        (e.prototype.draw = function () {
          (i.fillStyle = 'red'),
            i.fillRect(this.x, this.y, this.width, this.height);
        }),
        e
      );
    })(),
    r = (function () {
      function e() {
        (this.width = 50),
          (this.height = 50),
          (this.x = Math.random() * (t.width - this.width)),
          (this.y = 0);
      }
      return (
        (e.prototype.draw = function () {
          (i.fillStyle = 'blue'),
            i.fillRect(this.x, this.y, this.width, this.height);
        }),
        e
      );
    })(),
    h = 0,
    a = 0,
    l = 0,
    s = !1,
    f = !1,
    d = 0,
    u = 0,
    w = 'point',
    x = 3,
    y = !0,
    p = 'main',
    g = [],
    m = [];
  function T() {
    (e = requestAnimationFrame(T)),
      i.clearRect(0, 0, t.width, t.height),
      h++,
      'time' === w &&
        (h % 40 == 0 && l++,
        h % 1e3 == 0 && x < 6 && x++,
        i.fillText(String(l), 50, 100)),
      'point' === w && i.fillText(String(a), 50, 100);
    for (var n = 0; n < x; n++)
      if ((h + (90 / x) * n) % 90 == 0) {
        var y = new o(n);
        g.push(y);
      }
    if (
      (g.forEach(function (n, o, r) {
        var h = function (t) {
            return r
              .filter(function (t) {
                return t !== n;
              })
              .findIndex(function (i) {
                return t(i, n);
              });
          },
          s = h(v),
          f = h(S),
          d = h(b),
          u = -1 !== s || v(c, n),
          x = -1 !== f || S(c, n),
          y = -1 !== d || b(c, n);
        n.y < t.height ? !u && (n.y += 1) : (r.splice(o, 1), a++),
          u ? (E(n), R(n)) : x ? E(n) : y && R(n),
          0 === n.y &&
            (window.cancelAnimationFrame(e),
            (p = 'end'),
            i.clearRect(0, 200, t.width, 350),
            (i.fillStyle = 'green'),
            (i.font = 'bold 48px san-serif'),
            'point' === w && i.fillText(String(a), 50, 300),
            'time' === w && i.fillText(String(l), 50, 300),
            i.fillText('Game Over', 50, 400),
            (i.font = 'bold 30px san-serif'),
            i.fillText("Press 'Enter' to start!", 50, 500)),
          n.draw();
      }),
      h % 1e3 == 0)
    ) {
      var k = new r();
      m.push(k);
    }
    m.forEach(function (t, i, e) {
      var n = v(c, t) || S(c, t) || b(c, t);
      'point' === w && n && (a += 10),
        'time' === w && n && (l += 10),
        t.y < 900 && !n ? (t.y += 5) : e.splice(i, 1),
        t.draw();
    }),
      E(c),
      R(c),
      s && d++,
      f && u++,
      d > 3 && ((s = !1), (d = 0)),
      u > 3 && ((f = !1), (u = 0)),
      c.draw();
  }
  function v(t, i) {
    var e = Math.abs(t.x - i.x) < t.width,
      n = t.y - i.y === t.height;
    return e && n;
  }
  function S(t, i) {
    var e = t.x - i.x <= t.width && t.x - i.x > 0,
      n = Math.abs(t.y - i.y) < t.height;
    return e && n;
  }
  function b(t, i) {
    var e = i.x - t.x <= t.width && i.x - t.x > 0,
      n = Math.abs(t.y - i.y) < t.height;
    return e && n;
  }
  function E(t) {
    c.x > 0 && s && (t.x -= 10);
  }
  function R(i) {
    c.x + c.width < t.width && f && (i.x += 10);
  }
  function k() {
    'main' === p &&
      'point' === w &&
      x > 1 &&
      (x--,
      i.clearRect(0, 250, 500, 50),
      i.fillText('difficulty: '.concat(String(x)), 50, 300));
  }
  function A() {
    'main' === p &&
      'point' === w &&
      x < 6 &&
      (x++,
      i.clearRect(0, 250, 500, 50),
      i.fillText('difficulty: '.concat(String(x)), 50, 300));
  }
  function M() {
    'main' === p
      ? (i.clearRect(0, 200, 500, 130),
        'point' === w
          ? (w = 'time')
          : 'time' === w &&
            ((w = 'point'),
            i.fillText('difficulty: '.concat(String(x)), 50, 300)),
        i.fillText('Mode: '.concat(w.toUpperCase()), 50, 250))
      : 'start' === p && !0 === y && (g.splice(0), (y = !1));
  }
  function L() {
    'main' === p
      ? ((e = requestAnimationFrame(T)), 'time' === w && (x = 1), (p = 'start'))
      : 'end' === p &&
        (g.splice(0),
        m.splice(0),
        (h = 0),
        (a = 0),
        (y = !0),
        (e = requestAnimationFrame(T)),
        (p = 'start'));
  }
  'main' === p &&
    ((i.fillStyle = 'green'),
    (i.font = 'bold 48px san-serif'),
    i.fillText('Block a Block', 50, 400),
    (i.font = 'bold 30px san-serif'),
    i.fillText('Mode: '.concat(w.toUpperCase()), 50, 250),
    'point' === w && i.fillText('difficulty: '.concat(String(x)), 50, 300),
    i.fillText("Press 'Enter' to start!", 50, 500)),
    document.addEventListener('keydown', function (t) {
      switch (t.code) {
        case 'Enter':
          L();
          break;
        case 'ArrowLeft':
        case 'KeyA':
          k(), (s = !0);
          break;
        case 'ArrowRight':
        case 'KeyD':
          A(), (f = !0);
          break;
        case 'Space':
          M();
      }
    }),
    t.addEventListener('touchstart', function (i) {
      var e = i.changedTouches[0].clientX,
        c = i.changedTouches[0].clientY;
      (n = setTimeout(function () {
        L();
      }, 1e3)),
        c < 300 && M(),
        e < t.width / 2 ? (s = !0) : e > t.width / 2 && (f = !0);
    }),
    t.addEventListener('touchend', function (i) {
      var e = i.changedTouches[0].clientX;
      i.changedTouches[0].clientY,
        clearTimeout(n),
        e < t.width / 2 ? k() : e > t.width / 2 && A();
    }),
    t.addEventListener('touchmove', function () {
      clearTimeout(n);
    });
})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0RsRixFQUFPc0YsaUJBQWlCLGFBQWEsV0FDbkNVLGFBQWFoRixFQUNkLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9nYW1lLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW52YXMnKSBhcyBIVE1MQ2FudmFzRWxlbWVudDtcclxuY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJykhO1xyXG5cclxuY2FudmFzLndpZHRoID0gNjAwO1xyXG5jYW52YXMuaGVpZ2h0ID0gODAwO1xyXG5jYW52YXMuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCBibGFjayc7XHJcbmNhbnZhcy5zdHlsZS5wb3NpdGlvbiA9ICdmaXhlZCc7XHJcbmNhbnZhcy5zdHlsZS5sZWZ0ID0gYGNhbGMoNTAlIC0gJHtjYW52YXMud2lkdGggLyAyfXB4KWA7XHJcbmNhbnZhcy5zdHlsZS50b3AgPSBgY2FsYyg1MCUgLSAke2NhbnZhcy5oZWlnaHQgLyAyfXB4KWA7XHJcblxyXG53aGlsZSAod2luZG93LmlubmVyV2lkdGggPCBjYW52YXMud2lkdGgpIHtcclxuICBjYW52YXMud2lkdGggLT0gMjA7XHJcbiAgY2FudmFzLnN0eWxlLmxlZnQgPSBgY2FsYyg1MCUgLSAke2NhbnZhcy53aWR0aCAvIDJ9cHgpYDtcclxufVxyXG53aGlsZSAod2luZG93LmlubmVySGVpZ2h0IDwgY2FudmFzLmhlaWdodCkge1xyXG4gIGNhbnZhcy5oZWlnaHQgLT0gNTA7XHJcbiAgY2FudmFzLnN0eWxlLnRvcCA9IGBjYWxjKDUwJSAtICR7Y2FudmFzLmhlaWdodCAvIDJ9cHgpYDtcclxufVxyXG5cclxudHlwZSBGbiA9IChzdG9wZWRCbG9jazogQmxvY2ssIGJsb2NrOiBCbG9jaykgPT4gYm9vbGVhbjtcclxuXHJcbi8vIGNvbnN0IGltZzEgPSBuZXcgSW1hZ2UoKTtcclxuLy8gaW1nMS5zcmMgPSBcImJlYXIucG5nXCI7XHJcblxyXG5jb25zdCBwbGF5ZXIgPSB7XHJcbiAgd2lkdGg6IDUwLFxyXG4gIGhlaWdodDogNTAsXHJcbiAgeDogKGNhbnZhcy53aWR0aCAtIDUwKSAvIDIsXHJcbiAgeTogY2FudmFzLmhlaWdodCAtIDUwLFxyXG4gIGRyYXcoKSB7XHJcbiAgICBjdHguZmlsbFN0eWxlID0gJ2dyZWVuJztcclxuICAgIGN0eC5maWxsUmVjdCh0aGlzLngsIHRoaXMueSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gICAgLy8gY3R4LmRyYXdJbWFnZShpbWcxLCB0aGlzLngsIHRoaXMueSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gIH0sXHJcbn07XHJcblxyXG5jbGFzcyBCbG9jayB7XHJcbiAgeDogbnVtYmVyO1xyXG4gIHk6IG51bWJlcjtcclxuICB3aWR0aDogbnVtYmVyO1xyXG4gIGhlaWdodDogbnVtYmVyO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihsb2NhdGlvbjogbnVtYmVyKSB7XHJcbiAgICB0aGlzLndpZHRoID0gNTA7XHJcbiAgICB0aGlzLmhlaWdodCA9IDUwO1xyXG4gICAgdGhpcy54ID1cclxuICAgICAgTWF0aC5yYW5kb20oKSAqIChjYW52YXMud2lkdGggLyBkaWZmaWN1bHR5IC0gdGhpcy53aWR0aCkgK1xyXG4gICAgICBsb2NhdGlvbiAqIChjYW52YXMud2lkdGggLyBkaWZmaWN1bHR5KTtcclxuICAgIHRoaXMueSA9IDA7XHJcbiAgfVxyXG4gIGRyYXcoKSB7XHJcbiAgICBjdHguZmlsbFN0eWxlID0gJ3JlZCc7XHJcbiAgICBjdHguZmlsbFJlY3QodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuICB9XHJcbn1cclxuXHJcbmNsYXNzIEJvbnVzIHtcclxuICB4OiBudW1iZXI7XHJcbiAgeTogbnVtYmVyO1xyXG4gIHdpZHRoOiBudW1iZXI7XHJcbiAgaGVpZ2h0OiBudW1iZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy53aWR0aCA9IDUwO1xyXG4gICAgdGhpcy5oZWlnaHQgPSA1MDtcclxuICAgIHRoaXMueCA9IE1hdGgucmFuZG9tKCkgKiAoY2FudmFzLndpZHRoIC0gdGhpcy53aWR0aCk7XHJcbiAgICB0aGlzLnkgPSAwO1xyXG4gIH1cclxuICBkcmF3KCkge1xyXG4gICAgY3R4LmZpbGxTdHlsZSA9ICdibHVlJztcclxuICAgIGN0eC5maWxsUmVjdCh0aGlzLngsIHRoaXMueSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG4gIH1cclxufVxyXG5cclxubGV0IHRpbWVyID0gMDtcclxubGV0IHBvaW50U2NvcmUgPSAwO1xyXG5sZXQgdGltZVNjb3JlID0gMDtcclxubGV0IGdvTGVmdCA9IGZhbHNlO1xyXG5sZXQgZ29SaWdodCA9IGZhbHNlO1xyXG5sZXQgbGVmdFRpbWVyID0gMDtcclxubGV0IHJpZ2h0VGltZXIgPSAwO1xyXG5sZXQgbW9kZTogJ3BvaW50JyB8ICd0aW1lJyA9ICdwb2ludCc7XHJcbmxldCBkaWZmaWN1bHR5OiAxIHwgMiB8IDMgfCA0IHwgNSB8IDYgPSAzO1xyXG5sZXQgY2FuVXNlSXRlbSA9IHRydWU7XHJcbmxldCBjdXJTdGF0dXM6ICdpbnRybycgfCAnc3RhcnQnIHwgJ2VuZCcgPSAnaW50cm8nO1xyXG5sZXQgYW5pbWF0aW9uOiBudW1iZXI7XHJcbmxldCBsb25nVGFiVGltZXI6IE5vZGVKUy5UaW1lb3V0O1xyXG5cclxudmFyIEJMT0NLX1RJTUUgPSA5MDtcclxudmFyIE1PVkVfU1BFRUQgPSAxMDtcclxudmFyIFRJTUVSX1RJTUUgPSAzO1xyXG5cclxuY29uc3QgYmxvY2tBcnJheTogQmxvY2tbXSA9IFtdO1xyXG5jb25zdCBib251c0FycmF5OiBCb251c1tdID0gW107XHJcblxyXG5mdW5jdGlvbiBJbnRyb0V2ZW50KCkge1xyXG4gIGN0eC5maWxsU3R5bGUgPSAnZ3JlZW4nO1xyXG4gIGN0eC5mb250ID0gJ2JvbGQgNDhweCBzYW4tc2VyaWYnO1xyXG4gIGN0eC5maWxsVGV4dCgnQmxvY2sgYSBCbG9jaycsIDUwLCA0MDApO1xyXG4gIGN0eC5mb250ID0gJ2JvbGQgMzBweCBzYW4tc2VyaWYnO1xyXG4gIGN0eC5maWxsVGV4dChgTW9kZTogJHttb2RlLnRvVXBwZXJDYXNlKCl9YCwgNTAsIDI1MCk7XHJcbiAgbW9kZSA9PT0gJ3BvaW50JyAmJlxyXG4gICAgY3R4LmZpbGxUZXh0KGBkaWZmaWN1bHR5OiAke1N0cmluZyhkaWZmaWN1bHR5KX1gLCA1MCwgMzAwKTtcclxuICBjdHguZmlsbFRleHQoXCJQcmVzcyAnRW50ZXInIHRvIHN0YXJ0IVwiLCA1MCwgNTAwKTtcclxufVxyXG5cclxuaWYgKGN1clN0YXR1cyA9PT0gJ2ludHJvJykge1xyXG4gIEludHJvRXZlbnQoKTtcclxufVxyXG5mdW5jdGlvbiBGcmFtZSgpIHtcclxuICBhbmltYXRpb24gPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoRnJhbWUpO1xyXG4gIGN0eC5jbGVhclJlY3QoMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuICB0aW1lcisrO1xyXG4gIGlmIChtb2RlID09PSAndGltZScpIHtcclxuICAgIHRpbWVyICUgNDAgPT09IDAgJiYgdGltZVNjb3JlKys7XHJcbiAgICB0aW1lciAlIDEwMDAgPT09IDAgJiYgZGlmZmljdWx0eSA8IDYgJiYgZGlmZmljdWx0eSsrO1xyXG4gICAgY3R4LmZpbGxUZXh0KFN0cmluZyh0aW1lU2NvcmUpLCA1MCwgMTAwKTtcclxuICB9XHJcbiAgaWYgKG1vZGUgPT09ICdwb2ludCcpIHtcclxuICAgIGN0eC5maWxsVGV4dChTdHJpbmcocG9pbnRTY29yZSksIDUwLCAxMDApO1xyXG4gIH1cclxuXHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBkaWZmaWN1bHR5OyBpKyspIHtcclxuICAgIGlmICgodGltZXIgKyAoQkxPQ0tfVElNRSAvIGRpZmZpY3VsdHkpICogaSkgJSBCTE9DS19USU1FID09PSAwKSB7XHJcbiAgICAgIGNvbnN0IGJsb2NrID0gbmV3IEJsb2NrKGkpO1xyXG4gICAgICBibG9ja0FycmF5LnB1c2goYmxvY2spO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYmxvY2tBcnJheS5mb3JFYWNoKChibG9jaywgaW5kZXgsIGFycmF5KSA9PiB7XHJcbiAgICBjb25zdCBDb2xsaXNpb25DaGVjayA9IChmbjogRm4pID0+XHJcbiAgICAgIGFycmF5XHJcbiAgICAgICAgLmZpbHRlcigodikgPT4gdiAhPT0gYmxvY2spXHJcbiAgICAgICAgLmZpbmRJbmRleCgoc3RvcGVkQmxvY2spID0+IGZuKHN0b3BlZEJsb2NrLCBibG9jaykpO1xyXG4gICAgY29uc3QgY29sbGlzaW9uRWFjaE90aGVyID0gQ29sbGlzaW9uQ2hlY2soQ29sbGlzaW9uKTtcclxuICAgIGNvbnN0IExlZnRDb2xsaXNpb25FYWNoT3RoZXIgPSBDb2xsaXNpb25DaGVjayhMZWZ0Q29sbGlzaW9uKTtcclxuICAgIGNvbnN0IFJpZ2h0Q29sbGlzaW9uRWFjaE90aGVyID0gQ29sbGlzaW9uQ2hlY2soUmlnaHRDb2xsaXNpb24pO1xyXG4gICAgY29uc3Qgc3RhY2tpbmcgPSBjb2xsaXNpb25FYWNoT3RoZXIgIT09IC0xIHx8IENvbGxpc2lvbihwbGF5ZXIsIGJsb2NrKTtcclxuICAgIGNvbnN0IHB1c2hpbmdMZWZ0ID1cclxuICAgICAgTGVmdENvbGxpc2lvbkVhY2hPdGhlciAhPT0gLTEgfHwgTGVmdENvbGxpc2lvbihwbGF5ZXIsIGJsb2NrKTtcclxuICAgIGNvbnN0IHB1c2hpbmdSaWdodCA9XHJcbiAgICAgIFJpZ2h0Q29sbGlzaW9uRWFjaE90aGVyICE9PSAtMSB8fCBSaWdodENvbGxpc2lvbihwbGF5ZXIsIGJsb2NrKTtcclxuXHJcbiAgICBpZiAoYmxvY2sueSA8IGNhbnZhcy5oZWlnaHQpIHtcclxuICAgICAgIXN0YWNraW5nICYmIChibG9jay55ICs9IDEpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgYXJyYXkuc3BsaWNlKGluZGV4LCAxKTtcclxuICAgICAgcG9pbnRTY29yZSsrO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChzdGFja2luZykge1xyXG4gICAgICBHb0xlZnQoYmxvY2spO1xyXG4gICAgICBHb1JpZ2h0KGJsb2NrKTtcclxuICAgIH0gZWxzZSBpZiAocHVzaGluZ0xlZnQpIHtcclxuICAgICAgR29MZWZ0KGJsb2NrKTtcclxuICAgIH0gZWxzZSBpZiAocHVzaGluZ1JpZ2h0KSB7XHJcbiAgICAgIEdvUmlnaHQoYmxvY2spO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChibG9jay55ID09PSAwKSB7XHJcbiAgICAgIHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZShhbmltYXRpb24pO1xyXG4gICAgICBjdXJTdGF0dXMgPSAnZW5kJztcclxuICAgICAgY3R4LmNsZWFyUmVjdCgwLCAyMDAsIGNhbnZhcy53aWR0aCwgMzUwKTtcclxuICAgICAgY3R4LmZpbGxTdHlsZSA9ICdncmVlbic7XHJcbiAgICAgIGN0eC5mb250ID0gJ2JvbGQgNDhweCBzYW4tc2VyaWYnO1xyXG4gICAgICBtb2RlID09PSAncG9pbnQnICYmIGN0eC5maWxsVGV4dChTdHJpbmcocG9pbnRTY29yZSksIDUwLCAzMDApO1xyXG4gICAgICBtb2RlID09PSAndGltZScgJiYgY3R4LmZpbGxUZXh0KFN0cmluZyh0aW1lU2NvcmUpLCA1MCwgMzAwKTtcclxuICAgICAgY3R4LmZpbGxUZXh0KCdHYW1lIE92ZXInLCA1MCwgNDAwKTtcclxuICAgICAgY3R4LmZvbnQgPSAnYm9sZCAzMHB4IHNhbi1zZXJpZic7XHJcbiAgICAgIGN0eC5maWxsVGV4dChcIlByZXNzICdFbnRlcicgdG8gc3RhcnQhXCIsIDUwLCA1MDApO1xyXG4gICAgfVxyXG5cclxuICAgIGJsb2NrLmRyYXcoKTtcclxuICB9KTtcclxuXHJcbiAgLy8gYm9udXMgLS0tLS0tLS0tLS0tXHJcbiAgaWYgKHRpbWVyICUgMTAwMCA9PT0gMCkge1xyXG4gICAgY29uc3QgYm9udXMgPSBuZXcgQm9udXMoKTtcclxuICAgIGJvbnVzQXJyYXkucHVzaChib251cyk7XHJcbiAgfVxyXG4gIGJvbnVzQXJyYXkuZm9yRWFjaCgoYm9udXMsIGluZGV4LCBhcnJheSkgPT4ge1xyXG4gICAgY29uc3QgY29sbGlkZSA9XHJcbiAgICAgIENvbGxpc2lvbihwbGF5ZXIsIGJvbnVzKSB8fFxyXG4gICAgICBMZWZ0Q29sbGlzaW9uKHBsYXllciwgYm9udXMpIHx8XHJcbiAgICAgIFJpZ2h0Q29sbGlzaW9uKHBsYXllciwgYm9udXMpO1xyXG5cclxuICAgIG1vZGUgPT09ICdwb2ludCcgJiYgY29sbGlkZSAmJiAocG9pbnRTY29yZSArPSAxMCk7XHJcbiAgICBtb2RlID09PSAndGltZScgJiYgY29sbGlkZSAmJiAodGltZVNjb3JlICs9IDEwKTtcclxuXHJcbiAgICBib251cy55IDwgOTAwICYmICFjb2xsaWRlID8gKGJvbnVzLnkgKz0gNSkgOiBhcnJheS5zcGxpY2UoaW5kZXgsIDEpO1xyXG5cclxuICAgIGJvbnVzLmRyYXcoKTtcclxuICB9KTtcclxuXHJcbiAgLy8gY29udHJvbCAtLS0tLS0tLS0tLS1cclxuICBHb0xlZnQocGxheWVyKTtcclxuICBHb1JpZ2h0KHBsYXllcik7XHJcbiAgZ29MZWZ0ICYmIGxlZnRUaW1lcisrO1xyXG4gIGdvUmlnaHQgJiYgcmlnaHRUaW1lcisrO1xyXG4gIGlmIChsZWZ0VGltZXIgPiBUSU1FUl9USU1FKSB7XHJcbiAgICBnb0xlZnQgPSBmYWxzZTtcclxuICAgIGxlZnRUaW1lciA9IDA7XHJcbiAgfVxyXG4gIGlmIChyaWdodFRpbWVyID4gVElNRVJfVElNRSkge1xyXG4gICAgZ29SaWdodCA9IGZhbHNlO1xyXG4gICAgcmlnaHRUaW1lciA9IDA7XHJcbiAgfVxyXG5cclxuICBwbGF5ZXIuZHJhdygpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBDb2xsaXNpb24ocHJlOiBCbG9jaywgY3VyOiBCbG9jaykge1xyXG4gIGNvbnN0IHhDb2xsaXNpb24gPSBNYXRoLmFicyhwcmUueCAtIGN1ci54KSA8IHByZS53aWR0aDtcclxuICBjb25zdCB5Q29sbGlzaW9uID0gcHJlLnkgLSBjdXIueSA9PT0gcHJlLmhlaWdodDtcclxuICByZXR1cm4geENvbGxpc2lvbiAmJiB5Q29sbGlzaW9uO1xyXG59XHJcblxyXG5mdW5jdGlvbiBMZWZ0Q29sbGlzaW9uKHByZTogQmxvY2ssIGN1cjogQmxvY2spIHtcclxuICBjb25zdCB4Q29sbGlzaW9uID0gcHJlLnggLSBjdXIueCA8PSBwcmUud2lkdGggJiYgcHJlLnggLSBjdXIueCA+IDA7XHJcbiAgY29uc3QgeUNvbGxpc2lvbiA9IE1hdGguYWJzKHByZS55IC0gY3VyLnkpIDwgcHJlLmhlaWdodDtcclxuICByZXR1cm4geENvbGxpc2lvbiAmJiB5Q29sbGlzaW9uO1xyXG59XHJcblxyXG5mdW5jdGlvbiBSaWdodENvbGxpc2lvbihwcmU6IEJsb2NrLCBjdXI6IEJsb2NrKSB7XHJcbiAgY29uc3QgeENvbGxpc2lvbiA9IGN1ci54IC0gcHJlLnggPD0gcHJlLndpZHRoICYmIGN1ci54IC0gcHJlLnggPiAwO1xyXG4gIGNvbnN0IHlDb2xsaXNpb24gPSBNYXRoLmFicyhwcmUueSAtIGN1ci55KSA8IHByZS5oZWlnaHQ7XHJcbiAgcmV0dXJuIHhDb2xsaXNpb24gJiYgeUNvbGxpc2lvbjtcclxufVxyXG5cclxuZnVuY3Rpb24gR29MZWZ0KHRoaW5nOiBCbG9jaykge1xyXG4gIHBsYXllci54ID4gMCAmJiBnb0xlZnQgJiYgKHRoaW5nLnggLT0gTU9WRV9TUEVFRCk7XHJcbn1cclxuZnVuY3Rpb24gR29SaWdodCh0aGluZzogQmxvY2spIHtcclxuICBwbGF5ZXIueCArIHBsYXllci53aWR0aCA8IGNhbnZhcy53aWR0aCAmJiBnb1JpZ2h0ICYmICh0aGluZy54ICs9IE1PVkVfU1BFRUQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVMZWZ0RXZlbnQoKSB7XHJcbiAgaWYgKGN1clN0YXR1cyA9PT0gJ2ludHJvJyAmJiBtb2RlID09PSAncG9pbnQnICYmIGRpZmZpY3VsdHkgPiAxKSB7XHJcbiAgICBkaWZmaWN1bHR5LS07XHJcbiAgICBjdHguY2xlYXJSZWN0KDAsIDI1MCwgNTAwLCA1MCk7XHJcbiAgICBjdHguZmlsbFRleHQoYGRpZmZpY3VsdHk6ICR7U3RyaW5nKGRpZmZpY3VsdHkpfWAsIDUwLCAzMDApO1xyXG4gIH1cclxufVxyXG5mdW5jdGlvbiBoYW5kbGVSaWdodEV2ZW50KCkge1xyXG4gIGlmIChjdXJTdGF0dXMgPT09ICdpbnRybycgJiYgbW9kZSA9PT0gJ3BvaW50JyAmJiBkaWZmaWN1bHR5IDwgNikge1xyXG4gICAgZGlmZmljdWx0eSsrO1xyXG4gICAgY3R4LmNsZWFyUmVjdCgwLCAyNTAsIDUwMCwgNTApO1xyXG4gICAgY3R4LmZpbGxUZXh0KGBkaWZmaWN1bHR5OiAke1N0cmluZyhkaWZmaWN1bHR5KX1gLCA1MCwgMzAwKTtcclxuICB9XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlU3BhY2VFdmVudCgpIHtcclxuICBpZiAoY3VyU3RhdHVzID09PSAnaW50cm8nKSB7XHJcbiAgICBjdHguY2xlYXJSZWN0KDAsIDIwMCwgNTAwLCAxMzApO1xyXG4gICAgaWYgKG1vZGUgPT09ICdwb2ludCcpIHtcclxuICAgICAgbW9kZSA9ICd0aW1lJztcclxuICAgIH0gZWxzZSBpZiAobW9kZSA9PT0gJ3RpbWUnKSB7XHJcbiAgICAgIG1vZGUgPSAncG9pbnQnO1xyXG4gICAgICBjdHguZmlsbFRleHQoYGRpZmZpY3VsdHk6ICR7U3RyaW5nKGRpZmZpY3VsdHkpfWAsIDUwLCAzMDApO1xyXG4gICAgfVxyXG4gICAgY3R4LmZpbGxUZXh0KGBNb2RlOiAke21vZGUudG9VcHBlckNhc2UoKX1gLCA1MCwgMjUwKTtcclxuICB9IGVsc2UgaWYgKGN1clN0YXR1cyA9PT0gJ3N0YXJ0JyAmJiBjYW5Vc2VJdGVtID09PSB0cnVlKSB7XHJcbiAgICBibG9ja0FycmF5LnNwbGljZSgwKTtcclxuICAgIGNhblVzZUl0ZW0gPSBmYWxzZTtcclxuICB9XHJcbn1cclxuZnVuY3Rpb24gc3RhcnRFdmVudCgpIHtcclxuICBpZiAoY3VyU3RhdHVzID09PSAnaW50cm8nKSB7XHJcbiAgICBhbmltYXRpb24gPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoRnJhbWUpO1xyXG4gICAgbW9kZSA9PT0gJ3RpbWUnICYmIChkaWZmaWN1bHR5ID0gMSk7XHJcbiAgICBjdXJTdGF0dXMgPSAnc3RhcnQnO1xyXG4gIH0gZWxzZSBpZiAoY3VyU3RhdHVzID09PSAnZW5kJykge1xyXG4gICAgYmxvY2tBcnJheS5zcGxpY2UoMCk7XHJcbiAgICBib251c0FycmF5LnNwbGljZSgwKTtcclxuICAgIHRpbWVyID0gMDtcclxuICAgIHBvaW50U2NvcmUgPSAwO1xyXG4gICAgY2FuVXNlSXRlbSA9IHRydWU7XHJcbiAgICBhbmltYXRpb24gPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoRnJhbWUpO1xyXG4gICAgY3VyU3RhdHVzID0gJ3N0YXJ0JztcclxuICB9XHJcbn1cclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoa2V5KSA9PiB7XHJcbiAgc3dpdGNoIChrZXkuY29kZSkge1xyXG4gICAgY2FzZSAnRW50ZXInOlxyXG4gICAgICBzdGFydEV2ZW50KCk7XHJcbiAgICAgIGJyZWFrO1xyXG4gICAgY2FzZSAnQXJyb3dMZWZ0JzpcclxuICAgIGNhc2UgJ0tleUEnOlxyXG4gICAgICBoYW5kbGVMZWZ0RXZlbnQoKTtcclxuICAgICAgZ29MZWZ0ID0gdHJ1ZTtcclxuICAgICAgYnJlYWs7XHJcbiAgICBjYXNlICdBcnJvd1JpZ2h0JzpcclxuICAgIGNhc2UgJ0tleUQnOlxyXG4gICAgICBoYW5kbGVSaWdodEV2ZW50KCk7XHJcbiAgICAgIGdvUmlnaHQgPSB0cnVlO1xyXG4gICAgICBicmVhaztcclxuICAgIGNhc2UgJ1NwYWNlJzpcclxuICAgICAgaGFuZGxlU3BhY2VFdmVudCgpO1xyXG4gICAgICBicmVhaztcclxuICAgIC8vIGNhc2UgJ0VzY2FwZSc6XHJcbiAgICAvLyAgIGlmIChjdXJTdGF0dXMgPT09ICdlbmQnKSB7XHJcbiAgICAvLyAgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG4gICAgLy8gICAgIEludHJvRXZlbnQoKTtcclxuICAgIC8vICAgICBjdXJTdGF0dXMgPSAnaW50cm8nO1xyXG4gICAgLy8gICB9XHJcbiAgfVxyXG59KTtcclxuXHJcbmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgKGV2ZW50KSA9PiB7XHJcbiAgY29uc3QgeFRvdWNoID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WDtcclxuICBjb25zdCB5VG91Y2ggPSBldmVudC5jaGFuZ2VkVG91Y2hlc1swXS5jbGllbnRZO1xyXG5cclxuICBsb25nVGFiVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgIHN0YXJ0RXZlbnQoKTtcclxuICB9LCAxMDAwKTtcclxuXHJcbiAgaWYgKHlUb3VjaCA8IDMwMCkge1xyXG4gICAgaGFuZGxlU3BhY2VFdmVudCgpO1xyXG4gIH1cclxuICBpZiAoeFRvdWNoIDwgY2FudmFzLndpZHRoIC8gMikge1xyXG4gICAgZ29MZWZ0ID0gdHJ1ZTtcclxuICB9IGVsc2UgaWYgKHhUb3VjaCA+IGNhbnZhcy53aWR0aCAvIDIpIHtcclxuICAgIGdvUmlnaHQgPSB0cnVlO1xyXG4gIH1cclxufSk7XHJcbmNhbnZhcy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIChldmVudCkgPT4ge1xyXG4gIGNvbnN0IHhUb3VjaCA9IGV2ZW50LmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFg7XHJcbiAgY29uc3QgeVRvdWNoID0gZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WTtcclxuICBjbGVhclRpbWVvdXQobG9uZ1RhYlRpbWVyKTtcclxuICBpZiAoeFRvdWNoIDwgY2FudmFzLndpZHRoIC8gMikge1xyXG4gICAgaGFuZGxlTGVmdEV2ZW50KCk7XHJcbiAgfSBlbHNlIGlmICh4VG91Y2ggPiBjYW52YXMud2lkdGggLyAyKSB7XHJcbiAgICBoYW5kbGVSaWdodEV2ZW50KCk7XHJcbiAgfVxyXG59KTtcclxuY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsICgpID0+IHtcclxuICBjbGVhclRpbWVvdXQobG9uZ1RhYlRpbWVyKTtcclxufSk7XHJcbiJdLCJuYW1lcyI6WyJjYW52YXMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY3R4IiwiZ2V0Q29udGV4dCIsIndpZHRoIiwiaGVpZ2h0Iiwic3R5bGUiLCJib3JkZXIiLCJwb3NpdGlvbiIsImxlZnQiLCJ0b3AiLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJhbmltYXRpb24iLCJsb25nVGFiVGltZXIiLCJwbGF5ZXIiLCJ4IiwieSIsImRyYXciLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsInRoaXMiLCJsb2NhdGlvbiIsIk1hdGgiLCJyYW5kb20iLCJkaWZmaWN1bHR5IiwiQmxvY2siLCJCb251cyIsInRpbWVyIiwicG9pbnRTY29yZSIsInRpbWVTY29yZSIsImdvTGVmdCIsImdvUmlnaHQiLCJsZWZ0VGltZXIiLCJyaWdodFRpbWVyIiwibW9kZSIsImNhblVzZUl0ZW0iLCJjdXJTdGF0dXMiLCJibG9ja0FycmF5IiwiYm9udXNBcnJheSIsIkZyYW1lIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiY2xlYXJSZWN0IiwiZmlsbFRleHQiLCJTdHJpbmciLCJpIiwiYmxvY2siLCJwdXNoIiwiZm9yRWFjaCIsImluZGV4IiwiYXJyYXkiLCJDb2xsaXNpb25DaGVjayIsImZuIiwiZmlsdGVyIiwidiIsImZpbmRJbmRleCIsInN0b3BlZEJsb2NrIiwiY29sbGlzaW9uRWFjaE90aGVyIiwiQ29sbGlzaW9uIiwiTGVmdENvbGxpc2lvbkVhY2hPdGhlciIsIkxlZnRDb2xsaXNpb24iLCJSaWdodENvbGxpc2lvbkVhY2hPdGhlciIsIlJpZ2h0Q29sbGlzaW9uIiwic3RhY2tpbmciLCJwdXNoaW5nTGVmdCIsInB1c2hpbmdSaWdodCIsInNwbGljZSIsIkdvTGVmdCIsIkdvUmlnaHQiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsImZvbnQiLCJib251cyIsImNvbGxpZGUiLCJwcmUiLCJjdXIiLCJ4Q29sbGlzaW9uIiwiYWJzIiwieUNvbGxpc2lvbiIsInRoaW5nIiwiaGFuZGxlTGVmdEV2ZW50IiwiaGFuZGxlUmlnaHRFdmVudCIsImhhbmRsZVNwYWNlRXZlbnQiLCJ0b1VwcGVyQ2FzZSIsInN0YXJ0RXZlbnQiLCJhZGRFdmVudExpc3RlbmVyIiwia2V5IiwiY29kZSIsImV2ZW50IiwieFRvdWNoIiwiY2hhbmdlZFRvdWNoZXMiLCJjbGllbnRYIiwieVRvdWNoIiwiY2xpZW50WSIsInNldFRpbWVvdXQiLCJjbGVhclRpbWVvdXQiXSwic291cmNlUm9vdCI6IiJ9
